[{"path":"https://kharchenkolab.github.io/numbat/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Teng Gao. Maintainer, author. Evan Biederstedt. Author. Peter Kharchenko. Author. Yufeng Wu. Author.","code":""},{"path":"https://kharchenkolab.github.io/numbat/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Gao T, Biederstedt E, Kharchenko P, Wu Y (2022). scistreer: Maximum-Likelihood Perfect Phylogeny Scale. R package version 1.0.0, https://github.com/kharchenkolab/scistreer.","code":"@Manual{,   title = {scistreer: Maximum-Likelihood Perfect Phylogeny at Scale},   author = {Teng Gao and Evan Biederstedt and Peter Kharchenko and Yufeng Wu},   year = {2022},   note = {R package version 1.0.0},   url = {https://github.com/kharchenkolab/scistreer}, }"},{"path":"https://kharchenkolab.github.io/numbat/index.html","id":"scistreer","dir":"","previous_headings":"","what":"Maximum-Likelihood Perfect Phylogeny at Scale","title":"Maximum-Likelihood Perfect Phylogeny at Scale","text":"scistreer R/Rcpp implementation ScisTree algorithm (Wu et al, Bioinformatics 2019). improves scalability algorithm via RcppParallel applicable large single-cell datasets (>10,000 cells).","code":""},{"path":"https://kharchenkolab.github.io/numbat/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Maximum-Likelihood Perfect Phylogeny at Scale","text":"","code":"devtools::install_github('https://github.com/kharchenkolab/scistreer')"},{"path":"https://kharchenkolab.github.io/numbat/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Maximum-Likelihood Perfect Phylogeny at Scale","text":"Within R, need supply genotype probability matrix (cell x mutation), entry probability cell harbor mutation. example, output maximum likelihood tree ape::phylo object. can visualize output probablity matrix follows:","code":"treeML = run_scistree(P_example, ncores = 8, init = 'UPGMA', verbose = F) plot_phylo_heatmap(treeML, P_example)"},{"path":"https://kharchenkolab.github.io/numbat/index.html","id":"benchmark","dir":"","previous_headings":"","what":"Benchmark","title":"Maximum-Likelihood Perfect Phylogeny at Scale","text":"scistreer 10x faster original implementation single thread. runtime scistreer can reduced shared-memory multi-threading via RcppParallel.","code":""},{"path":"https://kharchenkolab.github.io/numbat/index.html","id":"citations","dir":"","previous_headings":"","what":"Citations","title":"Maximum-Likelihood Perfect Phylogeny at Scale","text":"original publication, please refer : > Yufeng Wu, Accurate efficient cell lineage tree inference noisy single cell data: maximum likelihood perfect phylogeny approach, Bioinformatics, Volume 36, Issue 3, 1 February 2020, Pages 742–750, https://doi.org/10.1093/bioinformatics/btz676 like cite package, please use: > Teng Gao, Evan Biederstedt, Peter Kharchenko, Yufeng Wu (2022). ScisTreeR: Speeding ScisTree Algorithm via RcppParallel. R package version 1.0.0. https://github.com/kharchenkolab/scistreer","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/P_example.html","id":null,"dir":"Reference","previous_headings":"","what":"example genotype probability matrix — P_example","title":"example genotype probability matrix — P_example","text":"example genotype probability matrix","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/P_example.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"example genotype probability matrix — P_example","text":"","code":"P_example"},{"path":"https://kharchenkolab.github.io/numbat/reference/P_example.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"example genotype probability matrix — P_example","text":"object class matrix (inherits array) 1000 rows 25 columns.","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/P_small.html","id":null,"dir":"Reference","previous_headings":"","what":"smaller example genotype probability matrix — P_small","title":"smaller example genotype probability matrix — P_small","text":"smaller example genotype probability matrix","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/P_small.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"smaller example genotype probability matrix — P_small","text":"","code":"P_small"},{"path":"https://kharchenkolab.github.io/numbat/reference/P_small.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"smaller example genotype probability matrix — P_small","text":"object class matrix (inherits array) 100 rows 25 columns.","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/annotate_tree.html","id":null,"dir":"Reference","previous_headings":"","what":"Find maximum lilkelihood assignment of mutations on a tree — annotate_tree","title":"Find maximum lilkelihood assignment of mutations on a tree — annotate_tree","text":"Find maximum lilkelihood assignment mutations tree","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/annotate_tree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find maximum lilkelihood assignment of mutations on a tree — annotate_tree","text":"","code":"annotate_tree(tree, P)"},{"path":"https://kharchenkolab.github.io/numbat/reference/annotate_tree.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find maximum lilkelihood assignment of mutations on a tree — annotate_tree","text":"tree phylo Single-cell phylogenetic tree P matrix Genotype probability matrix","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/annotate_tree.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find maximum lilkelihood assignment of mutations on a tree — annotate_tree","text":"list Mutation placements","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/annotate_tree.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find maximum lilkelihood assignment of mutations on a tree — annotate_tree","text":"","code":"gtree_small = annotate_tree(tree_small, P_small)"},{"path":"https://kharchenkolab.github.io/numbat/reference/get_mut_graph.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a single-cell phylogeny with mutation placements into a mutation graph — get_mut_graph","title":"Convert a single-cell phylogeny with mutation placements into a mutation graph — get_mut_graph","text":"Convert single-cell phylogeny mutation placements mutation graph","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/get_mut_graph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a single-cell phylogeny with mutation placements into a mutation graph — get_mut_graph","text":"","code":"get_mut_graph(gtree)"},{"path":"https://kharchenkolab.github.io/numbat/reference/get_mut_graph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a single-cell phylogeny with mutation placements into a mutation graph — get_mut_graph","text":"gtree tbl_graph single-cell phylogeny","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/get_mut_graph.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert a single-cell phylogeny with mutation placements into a mutation graph — get_mut_graph","text":"igraph Mutation graph","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/get_mut_graph.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert a single-cell phylogeny with mutation placements into a mutation graph — get_mut_graph","text":"","code":"mut_graph = get_mut_graph(annotate_tree(tree_small)) #> Error in colnames(P): argument \"P\" is missing, with no default"},{"path":"https://kharchenkolab.github.io/numbat/reference/label_edges.html","id":null,"dir":"Reference","previous_headings":"","what":"Annotate the direct upstream or downstream mutations on the edges — label_edges","title":"Annotate the direct upstream or downstream mutations on the edges — label_edges","text":"Annotate direct upstream downstream mutations edges","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/label_edges.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Annotate the direct upstream or downstream mutations on the edges — label_edges","text":"","code":"label_edges(G)"},{"path":"https://kharchenkolab.github.io/numbat/reference/label_edges.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Annotate the direct upstream or downstream mutations on the edges — label_edges","text":"G igraph Mutation graph","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/label_edges.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Annotate the direct upstream or downstream mutations on the edges — label_edges","text":"igraph Mutation graph","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/mut_to_tree.html","id":null,"dir":"Reference","previous_headings":"","what":"Transfer mutation assignment onto a single-cell phylogeny — mut_to_tree","title":"Transfer mutation assignment onto a single-cell phylogeny — mut_to_tree","text":"Transfer mutation assignment onto single-cell phylogeny","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/mut_to_tree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transfer mutation assignment onto a single-cell phylogeny — mut_to_tree","text":"","code":"mut_to_tree(gtree, mut_nodes)"},{"path":"https://kharchenkolab.github.io/numbat/reference/mut_to_tree.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transfer mutation assignment onto a single-cell phylogeny — mut_to_tree","text":"gtree tbl_graph single-cell phylogeny mut_nodes dataframe Mutation placements","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/mut_to_tree.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transfer mutation assignment onto a single-cell phylogeny — mut_to_tree","text":"tbl_graph single-cell phylogeny mutation placements","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/perform_nni.html","id":null,"dir":"Reference","previous_headings":"","what":"Maximum likelihood tree search via NNI — perform_nni","title":"Maximum likelihood tree search via NNI — perform_nni","text":"Maximum likelihood tree search via NNI","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/perform_nni.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Maximum likelihood tree search via NNI — perform_nni","text":"","code":"perform_nni(   tree_init,   P,   max_iter = 100,   eps = 0.01,   ncores = 1,   verbose = TRUE )"},{"path":"https://kharchenkolab.github.io/numbat/reference/perform_nni.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Maximum likelihood tree search via NNI — perform_nni","text":"tree_init phylo Intial tree P matrix Genotype probability matrix max_iter integer Maximum number iterations eps numeric Tolerance threshold likelihood difference stopping ncores integer Number cores use verbose logical Verbosity","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/perform_nni.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Maximum likelihood tree search via NNI — perform_nni","text":"multiPhylo List trees corresponding rearrangement steps","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/plot_phylo_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot phylogeny and mutation heatmap — plot_phylo_heatmap","title":"Plot phylogeny and mutation heatmap — plot_phylo_heatmap","text":"Plot phylogeny mutation heatmap","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/plot_phylo_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot phylogeny and mutation heatmap — plot_phylo_heatmap","text":"","code":"plot_phylo_heatmap(tree, P, branch_width = 0.5, root_edge = TRUE)"},{"path":"https://kharchenkolab.github.io/numbat/reference/plot_phylo_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot phylogeny and mutation heatmap — plot_phylo_heatmap","text":"tree phylo tbl_graph Phylogeny P matrix Genotype probability matrix branch_width numeric Branch width root_edge logical Whether plot root edge","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/plot_phylo_heatmap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot phylogeny and mutation heatmap — plot_phylo_heatmap","text":"","code":"p = plot_phylo_heatmap(tree_small, P_small)"},{"path":"https://kharchenkolab.github.io/numbat/reference/run_scistree.html","id":null,"dir":"Reference","previous_headings":"","what":"Run the scistree workflow — run_scistree","title":"Run the scistree workflow — run_scistree","text":"Run scistree workflow","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/run_scistree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run the scistree workflow — run_scistree","text":"","code":"run_scistree(   P,   init = \"UPGMA\",   ncores = 1,   max_iter = 100,   eps = 0.01,   verbose = TRUE )"},{"path":"https://kharchenkolab.github.io/numbat/reference/run_scistree.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run the scistree workflow — run_scistree","text":"P matrix Genotype probability matrix (cell x mutation). entry probability (0-1) locus wildtype init character Initialization strategy; UPGMA NJ ncores integer Number cores use max_iter integer Maximum number iterations eps numeric Tolerance threshold likelihood difference stopping verbose logical Verbosity","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/run_scistree.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run the scistree workflow — run_scistree","text":"phylo maximum-likelihood phylogeny","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/run_scistree.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run the scistree workflow — run_scistree","text":"","code":"tree_small = run_scistree(P_small) #> Iter 2 -1615.02320811337, 0.061s #> Iter 3 -1612.77216335458, 0.061s #> Iter 4 -1611.12211209147, 0.061s #> Iter 5 -1609.77582445349, 0.062s #> Iter 6 -1608.45689338799, 0.061s #> Iter 7 -1606.49695634093, 0.061s #> Iter 8 -1606.49695634093, 0.061s"},{"path":"https://kharchenkolab.github.io/numbat/reference/score_tree.html","id":null,"dir":"Reference","previous_headings":"","what":"score a tree based on maximum likelihood — score_tree","title":"score a tree based on maximum likelihood — score_tree","text":"score tree based maximum likelihood","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/score_tree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"score a tree based on maximum likelihood — score_tree","text":"","code":"score_tree(tree, P, get_l_matrix = FALSE)"},{"path":"https://kharchenkolab.github.io/numbat/reference/score_tree.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"score a tree based on maximum likelihood — score_tree","text":"tree phylo object P genotype probability matrix get_l_matrix whether compute whole likelihood matrix","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/score_tree.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"score a tree based on maximum likelihood — score_tree","text":"list Likelihood scores tree","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/to_phylo.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert the phylogeny from tidygraph to phylo object — to_phylo","title":"Convert the phylogeny from tidygraph to phylo object — to_phylo","text":"Convert phylogeny tidygraph phylo object","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/to_phylo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert the phylogeny from tidygraph to phylo object — to_phylo","text":"","code":"to_phylo(gtree)"},{"path":"https://kharchenkolab.github.io/numbat/reference/to_phylo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert the phylogeny from tidygraph to phylo object — to_phylo","text":"gtree tbl_graph single-cell phylogeny","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/to_phylo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert the phylogeny from tidygraph to phylo object — to_phylo","text":"phylo single-cell phylogeny","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/to_phylo.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert the phylogeny from tidygraph to phylo object — to_phylo","text":"","code":"tree_small = to_phylo(annotate_tree(tree_small)) #> Error in colnames(P): argument \"P\" is missing, with no default"},{"path":"https://kharchenkolab.github.io/numbat/reference/transfer_links.html","id":null,"dir":"Reference","previous_headings":"","what":"Annotate the direct upstream or downstream node on the edges — transfer_links","title":"Annotate the direct upstream or downstream node on the edges — transfer_links","text":"Annotate direct upstream downstream node edges","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/transfer_links.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Annotate the direct upstream or downstream node on the edges — transfer_links","text":"","code":"transfer_links(G)"},{"path":"https://kharchenkolab.github.io/numbat/reference/transfer_links.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Annotate the direct upstream or downstream node on the edges — transfer_links","text":"G igraph Mutation graph","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/transfer_links.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Annotate the direct upstream or downstream node on the edges — transfer_links","text":"igraph Mutation graph","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/tree_small.html","id":null,"dir":"Reference","previous_headings":"","what":"smaller example tree built from P_small — tree_small","title":"smaller example tree built from P_small — tree_small","text":"smaller example tree built P_small","code":""},{"path":"https://kharchenkolab.github.io/numbat/reference/tree_small.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"smaller example tree built from P_small — tree_small","text":"","code":"tree_small"},{"path":"https://kharchenkolab.github.io/numbat/reference/tree_small.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"smaller example tree built from P_small — tree_small","text":"object class phylo length 5.","code":""}]
